{% extends 'base.html' %}
{% load static %}
{% block title %}
    Каталог 
    {% if topic_name %}
    раздела &quot;{{ topic_name }}&quot;
    {% endif %}
    | {{ block.super }}
{% endblock %}

{% block main %}
<h1>Каталог библиотеки</h1>
<div>отображается {{ books|length }} книг.</div>
<h2>Категории:</h2>
<ul>
    {% for cat in cat_menu %}
<li>
    <a 
{% if request.resolver_match.kwargs.pk|add:'0' == cat.id %}current="page" {% endif %}
href="{% url 'catalog' cat.id %}">{{ cat.name }}</a>
</li>
    {% endfor %}
</ul>
<div>
{% if topic_name %}
Раздел: {{ topic_name }}.
{% else %}
Все книги
{% endif %}
</div>
<div>
    <ul>
        {% for book in books %}
            <li>
                {% if not topic_name %}
                {{ book.cat_fk.name }}
                {% endif %}
                {% if book.author %}
                {{ book.author }} 
                {% endif %}
                <a href="{% url 'book' book_id=book.id %}">
                {{ book.name }}
                </a>
            </li>
        {% endfor %}
    </ul>
</div>
{% endblock %}